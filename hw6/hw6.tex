\documentclass{article}
\linespread{1.3}
\usepackage[margin=50pt]{geometry}
\usepackage{amsmath, amsthm, amssymb, amsthm, tikz, fancyhdr, graphicx}
\pagestyle{fancy}
\renewcommand{\headrulewidth}{0pt}
\newcommand{\changefont}{\fontsize{15}{15}\selectfont}

\fancypagestyle{firstpageheader}
{
  \fancyhead[R]{\changefont Michael Huang \\ CFRM 420 \\ Homework 5}
}

\begin{document}

\thispagestyle{firstpageheader}

\section*{1.}
{\Large 

% \begin{verbatim}
%   Text enclosed inside \texttt{verbatim}
%   environment 
%   is printed directly 
%   and all \LaTeX{} commands are ignored.
% \end{verbatim}

% \framebox[1.1\width]{\textbf{answer}}

\subsection*{(a)}

See R file for the implementation: \\
\begin{verbatim}
  ORDINARY NONPARAMETRIC BOOTSTRAP


  Call:
  boot(data = data, statistic = cor.stat, R = 1)
  
  
  Bootstrap Statistics :
       original      bias    std. error
  t1* 0.6687307 0.001991947          NA
\end{verbatim}

\subsection*{(b)}

See R file for the implementation: \\
\begin{verbatim}
  ORDINARY NONPARAMETRIC BOOTSTRAP


  Call:
  boot(data = data, statistic = cor.stat, R = B)
  
  
  Bootstrap Statistics :
       original       bias    std. error
  t1* 0.6687307 6.870455e-05  0.01524621
\end{verbatim}

\subsection*{(c)}

We plot in R, and the distribution does seem to be approximately normal:
\begin{figure}[h!]
  \centering
  \includegraphics[width=500pt]{hw6_1c.png}
\end{figure}

\subsection*{(d)}

See R file for implementation: \\ 
\begin{verbatim}
  BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
Based on 10000 bootstrap replicates

CALL : 
boot.ci(boot.out = bootcor, conf = 0.95, type = c("norm", "perc"))

Intervals : 
Level      Normal             Percentile     
95%   ( 0.6388,  0.6985 )   ( 0.6379,  0.6976 )  
Calculations and Intervals on Original Scale
\end{verbatim}

\subsection*{(e)}

We can calculate the approximate 95\% confidence interval for $\hat{\rho}$ as given, with the fact that $n = 7252$ and $\hat{\rho} = 0.6687307$ as we find using R: \\
$(\hat{\rho} - 1.96 \frac{1 - \hat{\rho}^2}{\sqrt{n}}, \hat{\rho} + 1.96 \frac{1 - \hat{\rho}^2}{\sqrt{n}})$ \\
= $(0.6687307 - 1.96 \cdot \frac{1 - 0.6687307^2}{\sqrt{7252}}, 0.6687307 + 1.96 \cdot \frac{1 - 0.6687307^2}{\sqrt{7252}})$ \\
= $(0.6687307 - 1.96 \cdot \frac{1 - 0.44720074912}{\sqrt{7252}}, 0.6687307 + 1.96 \cdot \frac{1 - 0.44720074912}{\sqrt{7252}})$ \\
= $(0.6687307 - 1.96 \cdot \frac{0.55279925088}{\sqrt{7252}}, 0.6687307 + 1.96 \cdot \frac{0.55279925088}{\sqrt{7252}})$ \\
= $(0.6687307 - 1.96 \cdot 0.00649140264, 0.6687307 + 1.96 \cdot 0.00649140264)$ \\
= $(0.6687307 - 0.01272314917, 0.6687307 + 0.01272314917)$ \\
= $(0.65600755083, 0.68145384917)$ \\
This approximate 95\% confidence interval seems to be relatively close, but much more refined than both of the confidence intervals that we previously found. In this case, it seems that the normal is a little bit closer to these approximate values, since it is a little bit higher than those of the 95\% percentile confidence interval.
\newpage

}

\section*{2.}
{\Large

\subsection*{(a)}

We calculate and plot this using R, and it seems that the distribution is approximately normal, although a tiny bit off:
\begin{figure}[h!]
  \centering
  \includegraphics[width=500pt]{hw6_2a.png}
\end{figure}

\subsection*{(b)}

See R file for the implementation: \\
\begin{verbatim}
  BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
Based on 1000 bootstrap replicates

CALL : 
boot.ci(boot.out = bootmean, conf = 0.9, type = c("norm", "perc", 
    "bca"))

Intervals : 
Level      Normal             Percentile            BCa          
90%   ( 67.7, 139.6 )   ( 69.4, 141.8 )   ( 74.5, 152.3 )  
Calculations and Intervals on Original Scale
\end{verbatim}

\subsection*{(c)}

See R file for specific implementation. I achieved the following results. From these results, it seems that they were all pretty similar, weith the BCa having the largest confidence interval, followed by the percentile and normal, which were extremely close. The percentile tended to have lower quantile values than the BCa, and the normal had even lower values than the percentile. \\ \\ 
\begin{verbatim}
  print(ci.normal)
  [1]  71.42664 128.66163
  > print(ci.percent)
  [1]  72.89518 130.05975
  > print(ci.bca)
  [1]  75.85013 135.36732
\end{verbatim}

}

\end{document}